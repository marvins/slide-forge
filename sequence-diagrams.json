{"version":3,"kind":"Article","sha256":"33e11ab11c07f7b1a0ad861cd2948a972ab8744f9094dec1b65cac6a91365d42","slug":"sequence-diagrams","location":"/reference/sequence-diagrams.md","dependencies":[],"frontmatter":{"title":"Sequence Diagrams","content_includes_title":false,"authors":[{"nameParsed":{"literal":"Slide Forge Team","given":"Slide Forge","family":"Team"},"name":"Slide Forge Team","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/marvins/slide-forge","keywords":["latex","beamer","powerpoint","conversion","python"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/marvins/slide-forge/blob/main/docs/book/reference/sequence-diagrams.md","edit_url":"https://github.com/marvins/slide-forge/edit/main/docs/book/reference/sequence-diagrams.md","exports":[{"format":"md","filename":"sequence-diagrams.md","url":"/build/sequence-diagrams-509a5d6e3259dc59d94484c9899bd705.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This page contains sequence diagrams that illustrate the flow of operations within Slide Forge.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y6ZL2AEfhI"}],"key":"ePVIsRHU1h"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Conversion Flow Diagram","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TZt68ZebeZ"}],"identifier":"conversion-flow-diagram","label":"Conversion Flow Diagram","html_id":"conversion-flow-diagram","implicit":true,"key":"QVpEneqWtJ"},{"type":"mermaid","value":"sequenceDiagram\n    participant User\n    participant Core as Slide_Forge\n    participant Parser as LaTeX_Parser\n    participant Mapper as Content_Mapper\n    participant Builder as PowerPoint_Builder\n    participant File as File System\n\n    User->>Core: convert_file(input.tex, output.pptx)\n    Core->>Core: detect_format(input.tex)\n    Core->>Core: detect_format(output.pptx)\n    \n    Note over Core: Parsing Phase\n    Core->>Parser: parse_file(input.tex)\n    Parser->>File: read input.tex\n    File-->>Parser: LaTeX content\n    Parser->>Parser: parse LaTeX structure\n    Parser-->>Core: Universal_Document\n    \n    Note over Core: Mapping Phase\n    Core->>Mapper: map_document(document, 'pptx')\n    Mapper->>Mapper: _position_frame_elements()\n    loop For each frame\n        Mapper->>Mapper: _position_element()\n        Mapper->>Mapper: calculate layout\n    end\n    Mapper-->>Core: Positioned frames\n    \n    Note over Core: Building Phase\n    Core->>Builder: build_presentation(frames, output.pptx)\n    Builder->>Builder: create PowerPoint presentation\n    loop For each frame\n        Builder->>Builder: _add_elements_to_slide()\n        loop For each element\n            alt Element has position\n                Builder->>Builder: use element.position\n            else No position\n                Builder->>Builder: use fallback positioning\n            end\n            Builder->>Builder: render element\n        end\n    end\n    Builder->>File: save output.pptx\n    File-->>Builder: success\n    Builder-->>Core: True\n    Core-->>User: Conversion successful","position":{"start":{"line":7,"column":1},"end":{"line":54,"column":1}},"key":"gxfcpsO9Uv"},{"type":"heading","depth":2,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Component Initialization Diagram","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"hvNyR1Gvba"}],"identifier":"component-initialization-diagram","label":"Component Initialization Diagram","html_id":"component-initialization-diagram","implicit":true,"key":"mSSt7MMMTz"},{"type":"mermaid","value":"sequenceDiagram\n    participant Core as Slide_Forge\n    participant Parser as LaTeX_Parser\n    participant Builder as PowerPoint_Builder\n    participant Mapper as Content_Mapper\n    participant Detector as Format_Detector\n\n    Core->>Core: __init__()\n    Core->>Core: _initialize_components()\n    \n    Note over Core: Parser Registration\n    Core->>Parser: try import LaTeX_Parser\n    Parser-->>Core: LaTeX_Parser instance\n    Core->>Core: register_parser('latex', parser)\n    \n    Note over Core: Builder Registration  \n    Core->>Builder: try import PowerPoint_Builder\n    Builder-->>Core: PowerPoint_Builder instance\n    Core->>Core: register_builder('pptx', builder)\n    \n    Note over Core: Mapper Registration\n    Core->>Mapper: try import Content_Mapper\n    Mapper-->>Core: Content_Mapper instance\n    Core->>Core: register_mapper(mapper)\n    \n    Note over Core: Format Detector\n    Core->>Detector: Format_Detector()\n    Detector-->>Core: detector instance","position":{"start":{"line":58,"column":1},"end":{"line":87,"column":1}},"key":"hnNFQnMLry"},{"type":"heading","depth":2,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Image Path Resolution Diagram","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"ZC0v0aQ7BZ"}],"identifier":"image-path-resolution-diagram","label":"Image Path Resolution Diagram","html_id":"image-path-resolution-diagram","implicit":true,"key":"rofgRmq3pg"},{"type":"mermaid","value":"sequenceDiagram\n    participant Builder as PowerPoint_Builder\n    participant Element as Universal_Element\n    participant Path as pathlib.Path\n    participant File as File System\n\n    Builder->>Element: _add_image_element()\n    Element-->>Builder: image_path (relative)\n    \n    Builder->>Path: Path(image_path).is_absolute()\n    alt Absolute path\n        Path-->>Builder: True\n        Builder->>File: Path(image_path).exists()\n    else Relative path\n        Path-->>Builder: False\n        Builder->>Path: source_dir = Path(source_path).parent\n        Builder->>Path: image_path = source_dir / image_path\n        Builder->>File: image_path.exists()\n    end\n    \n    alt File exists\n        File-->>Builder: True\n        Builder->>Builder: slide_obj.shapes.add_picture()\n        Note over Builder: Image successfully added\n    else File not found\n        File-->>Builder: False\n        Builder->>Builder: logger.warning(\"Image file not found\")\n        Note over Builder: Image skipped with warning\n    end","position":{"start":{"line":91,"column":1},"end":{"line":121,"column":1}},"key":"oT130w8ZsA"},{"type":"heading","depth":2,"position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Error Handling Flow","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"NkPX5WnrOf"}],"identifier":"error-handling-flow","label":"Error Handling Flow","html_id":"error-handling-flow","implicit":true,"key":"PzWJZlMHvp"},{"type":"mermaid","value":"sequenceDiagram\n    participant User\n    participant Core as Slide_Forge\n    participant Parser as LaTeX_Parser\n    participant Builder as PowerPoint_Builder\n    participant Logger as logging\n\n    User->>Core: convert_file()\n    \n    alt Parser error\n        Core->>Parser: parse_file()\n        Parser-->>Core: ParseError\n        Core->>Logger: error(\"Parse failed\")\n        Core->>User: raise Slide_Forge_Error\n    else Mapping error\n        Core->>Mapper: map_document()\n        Mapper-->>Core: MappingError\n        Core->>Logger: error(\"Mapping failed\")\n        Core->>User: raise Slide_Forge_Error\n    else Builder error\n        Core->>Builder: build_presentation()\n        Builder->>Builder: element processing\n        Builder->>Logger: warning(\"Failed to add element\")\n        Note over Builder: Continue with other elements\n        Builder-->>Core: False (build failed)\n        Core->>Logger: error(\"Build failed\")\n        Core->>User: raise BuilderError\n    else Success\n        Core->>Builder: build_presentation()\n        Builder-->>Core: True\n        Core->>Logger: info(\"Successfully built\")\n        Core-->>User: True (success)\n    end","position":{"start":{"line":125,"column":1},"end":{"line":159,"column":1}},"key":"mVLIoaeVJ7"},{"type":"heading","depth":2,"position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"Layout Positioning Flow","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"LErEj6oBUm"}],"identifier":"layout-positioning-flow","label":"Layout Positioning Flow","html_id":"layout-positioning-flow","implicit":true,"key":"hOutEqfqIo"},{"type":"mermaid","value":"sequenceDiagram\n    participant Mapper as Content_Mapper\n    participant Frame as Universal_Frame\n    participant Element as Universal_Element\n    participant Position as Position\n\n    Mapper->>Frame: _position_frame_elements()\n    Note over Mapper: Initialize layout constants\n    Mapper->>Mapper: current_y = MARGIN_TOP\n    \n    loop For each element in frame\n        Mapper->>Element: _position_element()\n        Note over Element: Calculate element height\n        alt TEXT element\n            Element->>Element: _estimate_text_height()\n        else ITEMIZE element\n            Element->>Element: _estimate_itemize_height()\n        else IMAGE element\n            Element->>Element: height = 4.0\n        else Other element\n            Element->>Element: height = 0.5\n        end\n        \n        Element->>Position: Position(x, y, width, height)\n        Position-->>Element: position object\n        Element->>Element: Universal_Element with position\n        Element-->>Mapper: positioned_element\n        \n        Mapper->>Mapper: current_y += height + ELEMENT_SPACING\n    end\n    \n    Mapper->>Mapper: return positioned_frame","position":{"start":{"line":163,"column":1},"end":{"line":196,"column":1}},"key":"IahNkULgSz"},{"type":"heading","depth":2,"position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Font Size Handling Flow","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"hLlPGS6Ody"}],"identifier":"font-size-handling-flow","label":"Font Size Handling Flow","html_id":"font-size-handling-flow","implicit":true,"key":"eOtVt9cuhb"},{"type":"mermaid","value":"sequenceDiagram\n    participant Builder as PowerPoint_Builder\n    participant Config as Theme_Config\n    participant Pt as pptx.util.Pt\n    participant Font as Font Object\n\n    Builder->>Config: get('content_font_size', 18)\n    Config-->>Builder: font_size (integer)\n    \n    Builder->>Builder: if font_size > 0\n    alt Valid font size\n        Builder->>Pt: Pt(font_size)\n        Pt-->>Builder: Pt object (e.g., 228600)\n        Builder->>Font: font.size = Pt_object\n        Note over Builder: Font size set correctly\n    else Invalid font size (0)\n        Builder->>Builder: skip font.size assignment\n        Note over Builder: Uses PowerPoint default\n    end\n    \n    Note over Builder: Same pattern for title_font_size","position":{"start":{"line":200,"column":1},"end":{"line":222,"column":1}},"key":"ZneKs33nXo"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"These sequence diagrams illustrate the key flows and interactions within the Slide Forge system, helping developers understand the architecture and data flow.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"TfEApZKcOS"}],"key":"SgJYSpDvoO"}],"key":"yRCSGIGZd3"}],"key":"pz5H1auA2q"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Class Diagrams","url":"/class-diagrams","group":"Reference"},"next":{"title":"Design Notes","url":"/design-notes","group":"Design"}}},"domain":"http://localhost:3000"}